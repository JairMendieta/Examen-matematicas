<!DOCTYPE html>
<html lang="es" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Funciones | Blanco y Negro</title>
    <!-- Librerías de Estilos y Funcionalidad -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/function-plot/dist/function-plot.js"></script>
    <style>
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-family: monospace;
        }

        /* Asegura que el texto y las líneas del gráfico sean negras */
        .function-plot text {
            fill: black !important;
        }

        .function-plot .grid .tick line {
            stroke: #e5e7eb !important;
            /* Gris claro para la rejilla */
        }

        /* Estilo del scrollbar */
        .scroll-thin::-webkit-scrollbar {
            width: 8px;
        }

        .scroll-thin::-webkit-scrollbar-track {
            background: #f3f4f6;
        }

        /* bg-gray-100 */
        .scroll-thin::-webkit-scrollbar-thumb {
            background: #9ca3af;
            border-radius: 4px;
        }

        /* bg-gray-400 */
        .scroll-thin::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }

        /* bg-gray-500 */
    </style>
</head>

<body class="bg-white text-black h-full flex flex-col md:flex-row p-4 gap-4">
    <!-- === Panel de Control y Ejemplos (Izquierda) === -->
    <aside class="w-full md:w-1/3 lg:w-1/4 bg-white p-4 rounded-lg flex flex-col gap-4 border border-gray-200">
        <header>
            <h1 class="text-xl font-bold text-center">Simulador de Funciones</h1>
        </header>

        <!-- Input Manual -->
        <div class="flex flex-col gap-2">
            <label for="function-input" class="text-sm font-semibold">Inserta una función:</label>
            <div class="flex gap-2">
                <input id="function-input" type="text"
                    class="bg-white border border-gray-300 text-black text-sm rounded-lg focus:ring-black focus:border-black block w-full p-2.5"
                    value="x^2-6*x+5">
                <button id="plot-button"
                    class="bg-black text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors">Graficar</button>
            </div>
        </div>

        <!-- Ejemplos del PDF -->
        <div class="flex-grow overflow-y-auto scroll-thin pr-2">
            <h2 class="text-lg font-bold mb-2">Ejemplos</h2>
            <div id="examples-container" class="space-y-3">
                <div>
                    <h3 class="font-bold text-gray-800">Polinómicas</h3>
                    <div class="pl-2 border-l-2 border-gray-300 mt-1 space-y-1">
                        <button class="example-btn" data-fn="3">f(x) = 3</button>
                        <button class="example-btn" data-fn="x">f(x) = x</button>
                        <button class="example-btn" data-fn="-2*x - 1">f(x) = -2x-1</button>
                        <button class="example-btn" data-fn="x^2-6*x+5">f(x) = x^2-6x+5</button>
                    </div>
                </div>
                <div>
                    <h3 class="font-bold text-gray-800">Racionales</h3>
                    <div class="pl-2 border-l-2 border-gray-300 mt-1 space-y-1">
                        <button class="example-btn" data-fn="1/x">f(x) = 1/x</button>
                    </div>
                </div>
                <div>
                    <h3 class="font-bold text-gray-800">Otras</h3>
                    <div class="pl-2 border-l-2 border-gray-300 mt-1 space-y-1">
                        <button class="example-btn" data-fn="sqrt(x)">f(x) = sqrt(x)</button>
                        <button class="example-btn" data-fn="exp(x)">f(x) = e^x</button>
                    </div>
                </div>
            </div>
        </div>
    </aside>

    <!-- === Área de Gráfica (Derecha) === -->
    <main class="w-full md:w-2/3 lg:w-3/4 flex flex-col gap-2">
        <div id="plot" class="bg-white rounded-lg border border-gray-200 flex-grow w-full h-full"></div>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const functionInput = document.getElementById('function-input');
            const plotButton = document.getElementById('plot-button');
            const plotContainer = document.getElementById('plot');
            const exampleButtons = document.querySelectorAll('.example-btn');

            function plotFunction() {
                const fnString = functionInput.value;
                plotContainer.innerHTML = '';
                try {
                    functionPlot({
                        target: '#plot',
                        width: plotContainer.clientWidth,
                        height: plotContainer.clientHeight,
                        xAxis: { color: 'black' },
                        yAxis: { color: 'black' },
                        grid: true,
                        tip: { xLine: true, yLine: true },
                        data: [{
                            fn: fnString,
                            color: 'black', // Color de la línea de la función
                            graphType: 'polyline'
                        }]
                    });
                } catch (err) {
                    plotContainer.innerHTML = `<div class="flex items-center justify-center h-full text-red-600 p-4">Error: Función inválida.</div>`;
                    console.error(err);
                }
            }

            // --- Event Listeners ---
            plotButton.addEventListener('click', plotFunction);
            functionInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') plotFunction();
            });

            exampleButtons.forEach(button => {
                button.className = 'w-full text-left p-1.5 rounded-md text-sm text-gray-600 hover:bg-gray-100 hover:text-black transition-colors';
                button.addEventListener('click', () => {
                    functionInput.value = button.getAttribute('data-fn');
                    plotFunction();
                });
            });

            const resizeObserver = new ResizeObserver(entries => {
                setTimeout(plotFunction, 0);
            });
            resizeObserver.observe(plotContainer);

            // Carga Inicial
            plotFunction();
        });
    </script>
</body>

</html>